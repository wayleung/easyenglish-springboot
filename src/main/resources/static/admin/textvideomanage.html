<!doctype html>
<html lang="en">

<head>

    <!--IE兼容vue-->
    <script src="assets/scripts/polyfill.min.js"></script>
    <title>课文同步-益思英语管理端</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

    <!-- VENDOR CSS -->
    <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="assets/vendor/font-awesome/css/font-awesome.min.css">-->
    <link rel="stylesheet" href="assets/vendor/linearicons/style.css">
    <!-- MAIN CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <!-- FOR DEMO PURPOSES ONLY. You should remove this in your project -->
    <link rel="stylesheet" href="assets/css/demo.css">
    <!-- GOOGLE FONTS -->
    <link href="assets/css/googleapis.css" rel="stylesheet">
    <!-- ICONS -->
    <link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">

</head>

<body>
<!-- WRAPPER -->
<div id="wrapper">

    <div id="navbar"></div>

    <div id="sidebar"></div>

    <!-- MAIN -->
    <div class="main">
        <!-- MAIN CONTENT -->
        <div class="main-content">
            <div class="container-fluid">
                <h3 class="page-title">课文同步管理</h3>
                <div class="row">

                    <div class="col-md-12">
                        <!-- TABLE HOVER -->
                        <div class="panel">
                            <div class="panel-heading">
                                <h3 class="panel-title">课文同步信息</h3>
                            </div>
                            <div class="panel-body">
                                <button type="button" class="btn btn-primary btn-xs" data-toggle="modal" data-target="#addModal">增加
                                </button>
                                <!-- Modal -->
                                <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <form id="addForm">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <h4 class="modal-title">增加课文同步</h4>
                                            </div>
                                            <div class="modal-body">
                                                <div class="form-horizontal">
                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">标题</label>
                                                        <div class="col-md-10">
                                                            <input type="text" v-model="addinfo.title" class="form-control" id="title" name="title">
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">作者</label>
                                                        <div class="col-md-10">
                                                            <input type="text" v-model="addinfo.author" class="form-control" name="author">
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">年级</label>
                                                        <div class="col-md-10">
                                                            <select class="form-control" v-model="addinfo.grade" name="grade">
                                                                <option value="1">一</option>
                                                                <option value="2">二</option>
                                                                <option value="3">三</option>
                                                                <option value="4">四</option>
                                                                <option value="5">五</option>
                                                                <option value="6">六</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">Unit</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control" v-model="addinfo.unit" name="unit">
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">Part</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control" v-model="addinfo.part" name="part">
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">页码</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control" v-model="addinfo.page" name="page">
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">教材版本</label>
                                                        <div class="col-md-10">
                                                            <select class="form-control" v-model="addinfo.textbook" name="textbook">
                                                                <option value="1">一</option>
                                                                <option value="2">二</option>
                                                                <option value="3">三</option>
                                                                <option value="4">四</option>
                                                                <option value="5">五</option>
                                                                <option value="6">六</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="cover" class="col-md-2 control-label">封面</label>
                                                        <div class="col-md-10">
                                                            <input type="file" name="cover" id="cover" v-model="addinfo.cover">
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="image" class="col-md-2 control-label">正文插图</label>
                                                        <div class="col-md-10">
                                                            <input type="file"  name="image" id="image" v-model="addinfo.image" multiple="multiple">
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label for="video" class="col-md-2 control-label">课文录音</label>
                                                        <div class="col-md-10">
                                                            <input type="file"  name="video" id="video" v-model="addinfo.video">
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">摘要</label>
                                                        <div class="col-md-10">
                                                            <textarea class="form-control"  rows="2"  v-model="addinfo.digest" name="digest"></textarea>
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">正文</label>
                                                        <div class="col-md-10">
                                                            <textarea class="form-control"  rows="8"  v-model="addinfo.text" name="text"></textarea>
                                                        </div>
                                                    </div>



                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">备注</label>
                                                        <div class="col-md-10">
                                                            <textarea class="form-control"  rows="4"  v-model="addinfo.remark" name="remark"></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <p id="msgadd" style="color: red;text-align: center;"></p>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                                <button type="button" class="btn btn-primary" id="addButton">保存</button>
                                                <!--<input type="submit" class="btn btn-primary" value="保存" />-->
                                            </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <table id="textVideoManage"  class="table table-hover">
                                    <thead>
                                    <tr>
                                        <th>id</th>
                                        <th>标题</th>
                                        <th>作者</th>
                                        <!--<th>上传admin</th>-->
<!--                                        <th>阅读数</th>
                                        <th>点赞数</th>-->
                                        <!--<th>积分</th>-->

                                        <!--<th>类型</th>-->
                                        <th>年级</th>
                                        <th>教材版本</th>
                                        <th>Unit</th>
                                        <th>Part</th>
                                        <th>页码</th>
                                        <th>创建时间</th>
                                        <!--<th>上传时间</th>-->
                                        <th>更新时间</th>
                                        <!--<th>状态</th>-->
                                        <th>备注</th>
                                        <th>操作</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <template v-for="item in datas">
                                    <tr>
                                        <td>{{item.tvId}}</td>
                                        <td>{{item.title}}</td>
                                        <td>{{item.author}}</td>
                                        <td>{{item.grade}}</td>
                                        <td>{{item.textbook}}</td>
                                        <td>{{item.unit}}</td>
                                        <td>{{item.part}}</td>
                                        <td>{{item.page}}</td>
                                        <td>{{item.createTime|times}}</td>
                                        <td>{{item.updateTime|times}}</td>
                                        <td>{{item.remark}}</td>
                                        <td>
                                            <button type="button" v-on:click="Detail(item)" class="btn btn-success btn-xs" data-toggle="modal" data-target="#detailModal">详情
                                            </button>

                                            <button type="button" v-on:click="Update(item)" class="btn btn-warning btn-xs" data-toggle="modal" data-target="#updateModal">更新
                                            </button>

                                            <button type="button" v-on:click="Delete(item)" class="btn btn-danger btn-xs "  data-toggle="modal" data-target="#deleteModal">删除
                                            </button>
                                        </td>
                                    </tr>

                                    </template>


                                    </tbody>
                                </table>

                                <!-- Modal -->
                                <div class="modal fade" id="detailModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <h4 class="modal-title">课文同步详情</h4>
                                            </div>
                                            <div class="modal-body">
                                                <div class="form-horizontal">
                                                    <input type="hidden"  v-model="detailinfo.tvId">
                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">标题</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.title}}</p>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">作者</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.author}}</p>
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">年级</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.grade}}</p>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">Unit</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.unit}}</p>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">Part</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.part}}</p>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">页码</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.page}}</p>
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">教材版本</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.textbook}}</p>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="cover_detail" class="col-md-2 control-label">封面</label>
                                                        <div class="col-md-10">
                                                            <img  id="cover_detail" width="200" height="150"  :src="detailinfo.coverUrl"/>
                                                            <!--<input type="file" id="cover_detail" name="cover" v-model="detailinfo.cover">-->
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="image_detail" class="col-md-2 control-label">正文插图</label>
                                                        <div id="imgArea" class="col-md-10">
                                                            <!--<img id="image_detail" width="200" height="150"  :src="detailinfo.imgUrl"/>-->
                                                            <!--<input type="file"  id="image_detail" name="image" v-model="detailinfo.image">-->
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label for="video_detail" class="col-md-2 control-label">课文录音</label>

                                                        <div class="col-md-10">
                                                            <audio id="video_detail" :src="detailinfo.videoUrl" preload="auto" controls="controls" controlslist="nodownload">
                                                            您的浏览器不支持 audio 标签。
                                                            </audio>
                                                            <!--<input type="file"  id="video_detail" name="video" v-model="detailinfo.video">-->
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">摘要</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.digest}}</p>
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">正文</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.text}}</p>
                                                        </div>
                                                    </div>



                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">备注</label>
                                                        <div class="col-md-10">
                                                            <p style="padding: 6px 12px;">{{detailinfo.remark}}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <p id="msgdetail" style="color: red;text-align: center;"></p>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                                <!--<button type="button" class="btn btn-primary" id="detailButton">保存</button>-->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Modal -->
                                <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <form id="updateForm">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <h4 class="modal-title" id="myModalLabel">更新课文同步</h4>
                                            </div>
                                            <div class="modal-body">
                                                <div class="form-horizontal">
                                                    <input type="hidden"  :value="updateinfo.tvId" name="tvId">
                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">标题</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control"   v-model="updateinfo.title" id="title_update" name="title">
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">作者</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control"  v-model="updateinfo.author" name="author">
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">年级</label>
                                                        <div class="col-md-10">
                                                            <select class="form-control"  v-model="updateinfo.grade" name="grade">
                                                                <option value="1">一</option>
                                                                <option value="2">二</option>
                                                                <option value="3">三</option>
                                                                <option value="4">四</option>
                                                                <option value="5">五</option>
                                                                <option value="6">六</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">Unit</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control"  v-model="updateinfo.unit" name="unit">
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">Part</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control"  v-model="updateinfo.part" name="part">
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">页码</label>
                                                        <div class="col-md-10">
                                                            <input type="text" class="form-control"  v-model="updateinfo.page" name="page">
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">教材版本</label>
                                                        <div class="col-md-10">
                                                            <select class="form-control"  v-model="updateinfo.textbook" name="textbook">
                                                                <option value="1">一</option>
                                                                <option value="2">二</option>
                                                                <option value="3">三</option>
                                                                <option value="4">四</option>
                                                                <option value="5">五</option>
                                                                <option value="6">六</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">

                                                        <label for="cover_update" class="col-md-2 control-label">封面</label>
                                                        <div class="col-md-10">
                                                            <!--<img width="200" height="150" :src="updateinfo.coverUrl"/>-->
                                                            <input type="file" id="cover_update" name="cover" v-model="updateinfo.cover">
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>

                                                    <div class="form-group">

                                                        <label for="image_update" class="col-md-2 control-label">正文插图</label>
                                                        <div class="col-md-10">
                                                            <!--<img width="200" height="150"  :src="updateinfo.imgUrl"/>-->
                                                            <input type="file"  id="image_update" name="image" v-model="updateinfo.image" multiple="multiple">
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>


                                                    <div class="form-group">

                                                        <label for="video_update" class="col-md-2 control-label">课文录音</label>
                                                        <div class="col-md-10">
                                                            <!--<audio :src="updateinfo.videoUrl" preload="auto" controls="controls" controlslist="nodownload">-->
                                                                <!--您的浏览器不支持 audio 标签。-->
                                                            <!--</audio>-->
                                                            <input type="file"  id="video_update" name="video" v-model="updateinfo.video">
                                                            <!--<p class="help-block">
                                                                <em>Example block-level help text here.</em>
                                                            </p>-->
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">摘要</label>
                                                        <div class="col-md-10">
                                                            <textarea class="form-control"  rows="2"  v-model="updateinfo.digest" name="digest"></textarea>
                                                        </div>
                                                    </div>


                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">正文</label>
                                                        <div class="col-md-10">
                                                            <textarea class="form-control"  rows="8"  v-model="updateinfo.text" name="text"></textarea>
                                                        </div>
                                                    </div>



                                                    <div class="form-group">
                                                        <label class="col-md-2 control-label">备注</label>
                                                        <div class="col-md-10">
                                                            <textarea class="form-control"  rows="4"  v-model="updateinfo.remark" name="remark"></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <p id="msgupdate" style="color: red;text-align: center;"></p>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                                <button type="button" class="btn btn-primary" id="updateButton">保存</button>
                                            </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>


                                <!-- Modal -->
                                <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                    <div class="modal-dialog  modal-sm" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <h4 class="modal-title">警告</h4>
                                            </div>
                                            <div class="modal-body">
                                                <input type="hidden"  v-model="deleteinfo.tvId" id="tvId" name="">
                                                是否确认删除?
                                            </div>
                                            <p id="msgdelete" style="color: red;text-align: center;"></p>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                                <button type="button" class="btn btn-primary" id="deleteButton">确定</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>




                                <nav aria-label="Page navigation">
                                    <ul class="pagination">
                                        <!--<li><a href="#" aria-label="First">首页</a></li>-->
                                        <li  id="prevPage" onclick="prevPage()">
                                            <a style="cursor: pointer" aria-label="Previous">
                                                <span aria-hidden="true">上一页</span>
                                            </a>
                                        </li>
                                        <li>
                                            <span aria-hidden="true" id="pageNow">1</span>
                                        </li>
                                        <li>
                                            <span aria-hidden="true">/</span>
                                        </li>
                                        <li>
                                            <span aria-hidden="true" id="totalPage">10</span>
                                        </li>
                                        <li id="nextPage" onclick="nextPage()" >
                                            <a style="cursor: pointer" aria-label="Next">
                                                <span aria-hidden="true">下一页</span>
                                            </a>
                                        </li>

                                        <li><span>第<input type="text"  id="skipPageInput" style="width: 20px;height: 20px" />页</span> <a style="cursor: pointer" onclick="skipPage()">跳转</a>
                                        </li>
                                        <!--<li><a href="#" aria-label="Last">尾页</a></li>-->
                                    </ul>
                                </nav>

                            </div>
                        </div>
                        <!-- END TABLE HOVER -->
                    </div>
                </div>

            </div>
        </div>
        <!-- END MAIN CONTENT -->
    </div>
    <!-- END MAIN -->
    <div class="clearfix"></div>
    <div id="footer"></div>
</div>
<!-- END WRAPPER -->
<!-- Javascript -->

<script src="assets/vendor/jquery/jquery.min.js"></script>
<script src="assets/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="assets/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script src="assets/scripts/klorofil-common.js"></script>
<script src="assets/vendor/vue/vue.min.js"></script>

<script>


    function deleteAll(id){
        $('#'+id).empty();
    }

    function addMsg(id,msg){
        $('#'+id).text(msg);
    }


    /*
        $('#data_4 .input-group.date').datepicker({
            todayBtn : "linked",
            keyboardNavigation : false,
            forceParse : false,
            calendarWeeks : true,
            autoclose : true
        }); */

    function getHostPath() {
        var curWwwPath = window.document.location.href;
        var pathName = window.document.location.pathname;
        var pos = curWwwPath.indexOf(pathName);
        //获取主机地址，如： http://localhost:8083
        var localhostPath = curWwwPath.substring(0, pos);
        return localhostPath;
    }



    var rootPath = getHostPath() + "/admin/";


    var textVideo_vm =  new Vue({
        el: '#textVideoManage',
        data: {datas:{}},
        methods:{
            Detail:function(item){
                //console.log("111");
                var url  = rootPath+'selectTextVideoByPrimaryKey';
                detail_vm.$data.detailinfo = item;
                $.ajax({
                    url : url,
                    type : "get",
                    async : false,
                    dataType : "json",
                    data: {tvId:item.tvId},
                    //异步   注意数据的获取
                    success : function(data) {
                        //console.log(data)
                        deleteAll('imgArea')
                        if(data.success==true) {


                              var imgstr =  data.datas.imgUrl;

                                //console.log(imgstr)
                                var imgStr = imgstr.trim(';');
                                //console.log(imgStr);
                                var imgs  = imgStr.split(';')

                                for (var i  =0  ; i<imgs.length-1;i++){
                                    //console.log(imgs[i]);
                                    $('#imgArea').append("<img  width=\"200\" height=\"150\" style=\"margin-right: 10px;margin-bottom: 10px;\"  src="+imgs[i]+">");
                                // <img id="image_detail" width="200" height="150"  :src="detailinfo.imgUrl"/>
                                }


                        }



                    }
                });



            },

            Delete: function (item) //删除
            {
                console.log(item);
                delete_vm.$data.deleteinfo = item;
            },
            Update: function (item) //更新
            {
                console.log(item);
                //克隆一个对象   这样更新表单中改变数据 不会影响前端表单
                var databack = $.extend({}, item);
                update_vm.$data.updateinfo = databack;
                console.log(update_vm.$data.updateinfo);
            }
        },
        filters: {
            times: function (value) {
                if(value!=undefined&&value!=''&&value!=null){
                    let date = new Date(value) // nuw 一个时间
                    let getHours // 小时
                    let getMinutes // 分
                    if (date.getHours() < 10) {
                        getHours = "0" + date.getHours()
                    } else {
                        getHours = date.getHours()
                    }
// 判断小时是否小于10的补全：加0
                    if (date.getMinutes() < 10) {
                        getMinutes = "0" + date.getMinutes()
                    } else {
                        getMinutes = date.getMinutes()
                    }
// 判断分是否小于10的补全：加0
                    return date.getFullYear() + "-" + (date.getMonth() + 1) + "-" + date.getDate() + "  " + getHours + ":" + getMinutes // 返回转换后的值

                }else{
                    return '';
                }


            }
        }


    })



    function selectTextVideo() {

        var url = rootPath + "selectAllTextVideoByPage";


        console.log(url);
        $.ajax({
            url : url,
            type : "get",
            async : true,
            dataType : "json",
            //data: datas,
            //异步   注意数据的获取
            success : function(data) {
                if(data.success==true) {

                    textVideo_vm.datas=data.datas.data;
                    //分页
                    $('#pageNow').text(data.datas.pageNow);
                    $('#totalPage').text(data.datas.totalPage);
                }
                /* textVideo_vm.datas=data.datas; */


            }
        });
    }



    //function ajax(api,datas) {
    $(document).ready(
        selectTextVideo()
    );



    //分页





    function nextPage(){
        var pageNow = $('#pageNow').text();
        var totalPage = $('#totalPage').text();

        var nextPage = parseInt(pageNow) + 1;

        if (nextPage <= totalPage && nextPage > 0) {


            var url = 'selectAllTextVideoByPage';

            var grade_id = $('#grade_menu').val();


            var dataJson = {"pageNow": nextPage};

            if (grade_id > 0) {
                url = 'selectAllTextVideoByGradeByPage';
                dataJson = {"pageNow": nextPage,"gradeId": grade_id};
            }


            //console.log('nextPage'+nextPage);

            $.ajax({
                url: url,
                type: "get",
                async: true,
                dataType: "json",
                data:dataJson ,
                //异步   注意数据的获取
                success: function (data) {
                    console.log(data);
                    // //总页数
                    // var totalPage = data.datas.totalPage;
                    // //现在页码
                    // var pageNow = data.datas.pageNow;
                    // if(nextPage>0&&nextPage<totalPage){
                    if (data.success == true) {
                        textVideo_vm.datas = data.datas.data;
                        //分页
                        $('#pageNow').text(data.datas.pageNow);
                        $('#totalPage').text(data.datas.totalPage);
                    }
                    // }
                }
            });
        }

    }

    function prevPage(){
        var pageNow = $('#pageNow').text();
        var totalPage = $('#totalPage').text();

        var prevPage = parseInt(pageNow) - 1;

        if (prevPage <= totalPage && prevPage > 0) {


            var url = 'selectAllTextVideoByPage';

            var grade_id = $('#grade_menu').val();

            var dataJson = {"pageNow": prevPage};

            if (grade_id > 0) {
                url = 'selectAllTextVideoByGradeByPage';
                dataJson = {"pageNow": prevPage,"gradeId": grade_id};
            }


            //console.log('prevPage'+prevPage);

            $.ajax({
                url: url,
                type: "get",
                async: true,
                dataType: "json",
                data: dataJson,
                //异步   注意数据的获取
                success: function (data) {
                    console.log(data);
                    // //总页数
                    // var totalPage = data.datas.totalPage;
                    // //现在页码
                    // var pageNow = data.datas.pageNow;
                    // if(prevPage>0&&prevPage<totalPage){
                    if (data.success == true) {
                        textVideo_vm.datas = data.datas.data;
                        //分页
                        $('#pageNow').text(data.datas.pageNow);
                        $('#totalPage').text(data.datas.totalPage);
                    }
                    // }
                }
            });
        }
    }


    function skipPage() {
        var pageNow = $('#pageNow').text();
        var totalPage = $('#totalPage').text();

        var skipPage = $('#skipPageInput').val();

        if (typeof skipPage !== "undefined"&&skipPage!=null&&skipPage!=''&&!isNaN(skipPage)&&skipPage <= totalPage && skipPage > 0) {
            console.log(skipPage);

            var url = 'selectAllTextVideoByPage';

            var grade_id = $('#grade_menu').val();

            var dataJson = {"pageNow": skipPage};

            if (grade_id > 0) {
                url = 'selectAllTextVideoByGradeByPage';
                dataJson = {"pageNow": skipPage,"gradeId": grade_id};
            }


            //console.log('prevPage'+prevPage);

            $.ajax({
                url: url,
                type: "get",
                async: true,
                dataType: "json",
                data: dataJson,
                //异步   注意数据的获取
                success: function (data) {
                    console.log(data);
                    // //总页数
                    // var totalPage = data.datas.totalPage;
                    // //现在页码
                    // var pageNow = data.datas.pageNow;
                    // if(prevPage>0&&prevPage<totalPage){
                    if (data.success == true) {
                        textVideo_vm.datas = data.datas.data;
                        //分页
                        $('#pageNow').text(data.datas.pageNow);
                        $('#totalPage').text(data.datas.totalPage);
                    }
                    // }
                }
            });
        }
    }




    //给更新div添加数据
    var detail_vm = new Vue({
        el: "#detailModal",
        data: {
            detailinfo: {}
        }
    });





    //给更新div添加数据
    var update_vm = new Vue({
        el: "#updateModal",
        data: {
            updateinfo: {}
        }
    });


    $("#updateButton").click(
        function(){

            var title = $("#title_update").val();


            if(title==null||title==''){
                deleteAll('msgupdate');
                addMsg('msgupdate','标题不能为空');
            }else{
                console.log('update submit');
               /* $.post(rootPath+'updateTextVideoByPrimaryKey', update_vm.$data.updateinfo, function (result) {
                    if(result.success==true){
                        console.log(result);
                        window.location.reload();
                        //可以把vue.js数据替换从而更新更新到页面
                        //vm.$data.datas.splice(index, index, update_vm.$data.updateinfo);
                    }else{
                        deleteAll('msgupdate');
                        addMsg('msgupdate',result.msg);
                    }



                });*/
                var form = new FormData(document.getElementById("updateForm"));
                console.log(form);
                $.ajax({
                    url:rootPath+'updateTextVideoByPrimaryKey',
                    type : "post",
                    async : false,
                    //dataType : "json",
                    // 下面三个参数要指定，如果不指定，会报一个JQuery的错误
                    cache: false,
                    contentType: false,
                    processData: false,
                    //data:add_vm.$data.addinfo,
                    data:form,
                    success : function(result) {
                        if(result.success==true) {
                            console.log(result);
                            window.location.reload();
                        }else{
                            deleteAll('msgupdate');
                            addMsg('msgupdate',result.msg);
                        }
                    }
                });

            }

        }
    );


    var add_vm = new Vue({
        el: "#addModal",
        data: {
            addinfo: {}
        }
    });





    $("#addButton").click(





        function(){

            var title = $("#title").val();
            if(title==null||title==''){
                deleteAll('msgadd');
                addMsg('msgadd','标题不能为空');
            }
            else{
                $.ajax({
                    url:rootPath+"selectTextVideoByTitle",
                    type : "get",
                    async : true,
                    dataType : "json",
                    data:{'title':title},
                    success : function(datas) {

                        console.log(datas.success);
                        if(datas.success==true){
                            deleteAll('msgadd');
                            addMsg('msgadd','该标题已经存在，不能添加');

                        }else{
                            var image = document.getElementById("image").files;
                            var cover = document.getElementById("cover").files;
                            var video = document.getElementById("video").files;

                            console.log(image);
                            console.log(cover);
                            console.log(video);


                            var image1 =  document.getElementById("image");
                            var cover1 =  document.getElementById("cover");
                            var video1 =  document.getElementById("video");

                            //console.log(add_vm.$data.addinfo);

                            if(cover.length==0){
                                console.log("111");
                            };


                            if(image.length==0){
                                console.log("222");
                            };

                            if(video.length==0){
                                console.log("33");
                            };

                            console.log(image);
                            console.log(cover);
                            console.log(video);


                            /*
                            /*
                                                        add_vm.$data.addinfo.image = image;
                                                        add_vm.$data.addinfo.cover = cover;
                                                        add_vm.$data.addinfo.video = video;
                            */


                            console.log('add submit');
                            /*$.post(rootPath+'insertTextVideo', add_vm.$data.addinfo, function (result) {
                                console.log(result);
                                //window.location.reload();
                                //可以把vue.js数据替换从而更新更新到页面
                                // vm.$data.datas.splice(index, index, update_vm.$data.updateinfo);
                            });*/
                            //var formData = new FormData($("#addForm")[0]);

                            //console.log(formData);
                            var form = new FormData(document.getElementById("addForm"));
                            console.log(form);
                            $.ajax({
                                url:rootPath+'insertTextVideo',
                                type : "post",
                                async : false,
                                //dataType : "json",
                                // 下面三个参数要指定，如果不指定，会报一个JQuery的错误
                                cache: false,
                                contentType: false,
                                processData: false,
                                //data:add_vm.$data.addinfo,
                                data:form,
                                success : function(result) {
                                    if(result.success==true) {
                                        console.log(result);
                                        window.location.reload();
                                    }else{
                                        deleteAll('msgadd');
                                        addMsg('msgadd',result.msg);
                                    }
                                }
                            });





                        }
                    }

                });
/*                var form = document.getElementById('addForm');
                //再次修改input内容

                form.submit();
                window.location.reload();*/
            }

        }



    );


    //给更新div添加数据
    var delete_vm = new Vue({
        el: "#deleteModal",
        data: {
            deleteinfo:{}
        }
    });


    $("#deleteButton").click(
        function(){
            console.log('del submit', delete_vm.$data.deleteinfo);
            $.post(rootPath+'deleteTextVideoByPrimaryKey', delete_vm.$data.deleteinfo, function (result) {
                if(result.success==true) {
                    console.log(result);
                    window.location.reload();
                }else{
                    deleteAll('msgdelete');
                    addMsg('msgdelete',result.msg);
                }

                //可以把vue.js数据替换从而更新更新到页面
                /* 	        vm.$data.datas.splice(index, index, update_vm.$data.updateinfo);   */

            });
        }
    );


</script>


<script>

    /*导入头部和尾部*/
    $(document).ready(function () {
        $("#navbar").load("navbar.html");
        $("#sidebar").load("sidebar.html");
        $("#footer").load("footer.html");
    });
</script>
</body>

</html>
